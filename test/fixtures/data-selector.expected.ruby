(raise "Assertion failed" unless (->(s) { JSON.parse(s, symbolize_names: true) rescue raise ".: invalid JSON: #{s.inspect}" }).call("{\"name\": \"Alice\"}") == {name: "Alice"}; true)
(raise "Assertion failed" unless (->(s) { JSON.parse(s, symbolize_names: true) rescue raise ".: invalid JSON: #{s.inspect}" }).call("[1, 2, 3]") == [1, 2, 3]; true)
(raise "Assertion failed" unless (->(s) { JSON.parse(s, symbolize_names: true) rescue raise ".: invalid JSON: #{s.inspect}" }).call("{\"user\": {\"name\": \"Bob\"}}")[:user][:name] == "Bob"; true)
(raise "Assertion failed" unless (->(s) { JSON.parse(s, symbolize_names: true) rescue raise ".: invalid JSON: #{s.inspect}" }).call("{\"active\": true}")[:active] == true; true)
(raise "Assertion failed" unless (->(s) { JSON.parse(s, symbolize_names: true) rescue raise ".: invalid JSON: #{s.inspect}" }).call("{\"count\": 42}")[:count] == 42; true)
(raise "Assertion failed" unless [1, 2, 3] == [1, 2, 3]; true)
(raise "Assertion failed" unless {x: 10}[:x] == 10; true)
(begin; (->() { (->(s) { JSON.parse(s, symbolize_names: true) rescue raise ".: invalid JSON: #{s.inspect}" }).call("not valid json") }).call; raise "Expected error but none thrown"; rescue => e; raise e if e.message == "Expected error but none thrown"; true; end)
(raise "Assertion failed" unless ((->(v) { case v when String; JSON.parse(v, symbolize_names: true) rescue raise ".: invalid JSON: #{v.inspect}" else v end }).call(nil)).nil?; true)
(begin; (->() { (->(s) { JSON.parse(s, symbolize_names: true) rescue raise ".: invalid JSON: #{s.inspect}" }).call("invalid") }).call; raise "Expected error but none thrown"; rescue => e; raise e if e.message == "Expected error but none thrown"; true; end)

